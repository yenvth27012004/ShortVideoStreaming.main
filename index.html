<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>YouTube Shorts Swipe</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background-color: #000;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }
    #shorts-container {
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      border-radius: 16px;
      position: fixed;
      background: #000;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 32px rgba(0,0,0,0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .short {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      transition: transform 0.4s ease;
    }
    iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: #000;
      display: block;
    }
  </style>
</head>
<body>
  <div id="shorts-container">
    <div class="short" style="transform: translateY(0%)">
      <iframe id="ytplayer0" src="https://www.youtube.com/embed/alhQosN8h7M?autoplay=1&mute=1&controls=0&loop=1&enablejsapi=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
    <div class="short" style="transform: translateY(100%)">
      <iframe id="ytplayer1" src="https://www.youtube.com/embed/HtOJT_yxj9g?autoplay=1&mute=1&controls=0&loop=1&enablejsapi=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
    <div class="short" style="transform: translateY(200%)">
      <iframe id="ytplayer2" src="https://www.youtube.com/embed/YTwK96HddCo?autoplay=1&mute=1&controls=0&loop=1&enablejsapi=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
  </div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    const shorts = document.querySelectorAll('.short');
    let currentIndex = 0;
    let startY = 0;
    let isTouch = false;

    // --- Play time tracking ---
    const playTimes = Array(shorts.length).fill(0); // ms
    let playStart = Date.now();

    function logPlayTime(index) {
      const now = Date.now();
      playTimes[index] += now - playStart;
      console.log(`Video ${index} play time: ${playTimes[index] / 1000}s`);
      playStart = now;
    }

    // --- Log video duration ---
    let ytPlayers = [];
    function onYouTubeIframeAPIReady() {
      shorts.forEach((short, i) => {
        const iframe = short.querySelector('iframe');
        ytPlayers[i] = new YT.Player(iframe.id, {
          events: {
            'onReady': (event) => {
              const duration = event.target.getDuration();
              console.log(`Video ${i} duration: ${duration}s`);
            }
          }
        });
      });
    }

    // --- Touch events (mobile & touchpad) ---
    document.addEventListener('touchstart', (e) => {
      console.log('Touch start detected');
      isTouch = true;
      startY = e.touches[0].clientY;
    });

    document.addEventListener('touchend', (e) => {
      if (!isTouch) return;
      const endY = e.changedTouches[0].clientY;
      handleSwipe(endY - startY);
    });

    // Mouse events (touchpad swipe)
    let mouseDown = false;
    let mouseStartY = 0;
    document.addEventListener('mousedown', (e) => {
      isTouch = false;
      mouseDown = true;
      mouseStartY = e.clientY;
    });

    document.addEventListener('mouseup', (e) => {
      if (!mouseDown) return;
      mouseDown = false;
      const deltaY = e.clientY - mouseStartY;
      handleSwipe(deltaY);
    });

    // Wheel event (for touchpad two-finger swipe)
    document.addEventListener('wheel', (e) => {
      // Only vertical scroll
      if (Math.abs(e.deltaY) > Math.abs(e.deltaX) && Math.abs(e.deltaY) > 5) {
        handleSwipe(e.deltaY);
      }
    });

    // Keyboard events for up/down arrow keys
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowDown') {
        console.log('ArrowDown key pressed');
        handleSwipe(-100); // Simulate swipe up
      } else if (e.key === 'ArrowUp') {
        console.log('ArrowUp key pressed');
        handleSwipe(100); // Simulate swipe down
      }
    });

    function handleSwipe(deltaY) {
      if (isTouch) {
        // For touch events
        deltaY = -deltaY; // Invert for touch swipe direction
      } else if (mouseDown) {
        // For mouse events
        deltaY = -deltaY; // Invert for mouse swipe direction
      }
      if (Math.abs(deltaY) > 5) {
        if (deltaY < 0 && currentIndex < shorts.length - 1) {
          logPlayTime(currentIndex);
          currentIndex++;
        } else if (deltaY > 0 && currentIndex > 0) {
          logPlayTime(currentIndex);
          currentIndex--;
        }
        updateShorts();
      }
    }

    function updateShorts() {
      shorts.forEach((short, index) => {
        short.style.transform = `translateY(${(index - currentIndex) * 100}%)`;
        const iframe = short.querySelector('iframe');
        iframe.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
      });
      const currentIframe = shorts[currentIndex].querySelector('iframe');
      currentIframe.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
      playStart = Date.now();
    }

    // Log play time when user leaves the page
    window.addEventListener('beforeunload', () => {
      logPlayTime(currentIndex);
      playTimes.forEach((t, i) => {
        console.log(`Final Video ${i} play time: ${t / 1000}s`);
      });
    });
  </script>
</body>
</html>
